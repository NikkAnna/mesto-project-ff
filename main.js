(()=>{"use strict";var t={baseUrl:"https://nomoreparties.co/v1/wff-cohort-12",headers:{authorization:"8f4967ce-f48f-4d37-a0f6-afbb9d7f6d1e","Content-Type":"application/json"}},e=function(t){return t.ok?t.json():Promise.reject("Что-то пошло не так: ".concat(t.status))},n=document.querySelector("#card-template").content;function o(t,e,o,r,u,c,a,i,l,s,p){var d=arguments.length>11&&void 0!==arguments[11]?arguments[11]:"красивая фотография",_=n.querySelector(".places__item").cloneNode(!0),f=_.querySelector(".card__image");f.src=t,f.alt=d,_.querySelector(".card__title").textContent=e,f.addEventListener("click",(function(){return r(t,e,d)}));var m=o.length,y=_.querySelector(".card__like-counter");y.textContent=m;var v=_.querySelector(".card__like-button");v.addEventListener("click",(function(t){u(t,c,y)})),o.some((function(t){return t._id===a}))?v.classList.add("card__like-button_is-active"):v.classList.remove("card__like-button_is-active");var h=_.querySelector(".card__delete-button");return i._id===a?h.addEventListener("click",(function(){return l(s,c,_,p)})):h.style.display="none",_}function r(t){t.classList.add("popup_is-opened"),document.addEventListener("keydown",c)}function u(t){t.classList.remove("popup_is-opened"),document.removeEventListener("keydown",c)}function c(t){"Escape"===t.key&&u(document.querySelector(".popup_is-opened"))}function a(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.remove(n),r.classList.remove(o),r.textContent=""}function i(t,e,n){!function(t){return t.some((function(t){return!t.validity.valid}))}(t)?(e.disabled=!1,e.classList.remove(n)):(e.disabled=!0,e.classList.add(n))}function l(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=e.inputErrorClass,r=e.errorClass,u=t.querySelector(e.submitButtonSelector);n.forEach((function(e){a(t,e,o,r)})),u.disabled=!0,u.classList.add(e.inactiveButtonClass)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var p,d=document.querySelectorAll(".popup"),_=document.querySelector(".places__list"),f=document.querySelector(".profile__title"),m=document.querySelector(".profile__description"),y=document.querySelector(".profile__image"),v=document.querySelector(".popup_type_new-avatar"),h=document.forms["new-avatar"],b=document.querySelector(".popup__input_type_avatar_url"),S=v.querySelector(".popup__button"),C=document.querySelector(".popup_type_edit"),q=document.querySelector(".profile__edit-button"),g=document.forms["edit-profile"],E=document.querySelector(".popup__input_type_name"),L=document.querySelector(".popup__input_type_description"),k=C.querySelector(".popup__button"),x=document.querySelector(".popup_type_new-card"),A=document.querySelector(".profile__add-button"),w=document.forms["new-place"],B=document.querySelector(".popup__input_type_card-name"),T=document.querySelector(".popup__input_type_url"),U=x.querySelector(".popup__button"),j=document.querySelector(".popup_type_image"),O=j.querySelector(".popup__image"),D=j.querySelector(".popup__caption"),P=document.forms["delete-form"],I=document.querySelector(".popup_type_delete-card"),M="".concat(t.baseUrl,"/users/me"),N="".concat(t.baseUrl,"/cards"),J="".concat(t.baseUrl,"/users/me/avatar");function G(n,o,r){n.target.classList.toggle("card__like-button_is-active"),n.target.classList.contains("card__like-button_is-active")?function(t,n){return fetch(t,{method:"PUT",headers:n.headers}).then(e)}("".concat(t.baseUrl,"/cards/likes/").concat(o),t).then((function(t){r.textContent=t.likes.length})).catch((function(t){console.log(t)})):function(t,n){return fetch(t,{method:"DELETE",headers:n.headers}).then(e)}("".concat(t.baseUrl,"/cards/likes/").concat(o),t).then((function(t){r.textContent=t.likes.length})).catch((function(t){console.log(t)}))}function H(t,e){t.value="",e.value=""}function V(t,e,n){O.src=t,O.alt=n,D.textContent=e,r(j)}function z(n,o,c,a){n.addEventListener("submit",(function(n){n.preventDefault(),function(n,o){(function(t,n){return fetch(t,{method:"DELETE",headers:n.headers}).then(e)})("".concat(t.baseUrl,"/cards/").concat(o),t).then((function(t){return n.remove()})).catch((function(t){console.log(t)}))}(c,o),u(a)})),r(a)}Promise.all([function(t,n){return fetch(t,{method:"GET",headers:n.headers}).then(e)}(M,t),function(t,n){return fetch(t,{method:"GET",headers:n.headers}).then(e)}(N,t)]).then((function(n){var r,c,a=(c=2,function(t){if(Array.isArray(t))return t}(r=n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,u,c,a=[],i=!0,l=!1;try{if(u=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;i=!1}else for(;!(i=(o=u.call(n)).done)&&(a.push(o.value),a.length!==e);i=!0);}catch(t){l=!0,r=t}finally{try{if(!i&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(l)throw r}}return a}}(r,c)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(t,e):void 0}}(r,c)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=a[0],l=a[1];f.textContent=i.name,m.textContent=i.about,y.style.backgroundImage="url(".concat(i.avatar,")"),w.addEventListener("submit",(function(n){(function(n,r,c,a,i,l,s,p,d,_,f){n.preventDefault(),function(t,n,o){return fetch(t,{method:"POST",headers:n.headers,body:JSON.stringify(o)}).then(e)}(N,t,{name:a.value,link:c.value}).then((function(t){var e=o(c.value,a.value,[],i,l,t._id,p._id,p,d,_,f);s.prepend(e),u(r),H(a,c)})).catch((function(t){console.log(t)}))})(n,x,T,B,V,G,_,i,z,P,I),U.textContent="Создание..."})),l.forEach((function(t){var e;e=o(t.link,t.name,t.likes,V,G,t._id,i._id,t.owner,z,P,I),_.append(e)}))})).catch((function(t){console.log(t)})),y.addEventListener("click",(function(){b.value="",l(h,{inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),S.textContent="Сохранить",r(v)})),h.addEventListener("submit",(function(n){(function(t,n,o,r,c,a){t.preventDefault(),function(t,n,o){return fetch(t,{method:"PATCH",headers:n.headers,body:JSON.stringify({avatar:o})}).then(e)}(o,r,c).then((function(t){a.style.backgroundImage="url(".concat(t.avatar,")")})).catch((function(t){console.log(t)})),u(n)})(n,v,J,t,b.value,y),S.textContent="Сохранение..."})),q.addEventListener("click",(function(){!function(t,e,n,o){t.value=n,e.value=o,k.textContent="Сохранить"}(E,L,f.textContent,m.textContent),l(g,{inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),r(C)})),g.addEventListener("submit",(function(n){(function(n,o,r,c,a,i){n.preventDefault(),a.textContent=r,i.textContent=c,function(t,n,o){fetch(t,{method:"PATCH",headers:n.headers,body:JSON.stringify(o)}).then(e).catch((function(t){console.log(t)}))}(M,t,{name:a.textContent,about:i.textContent}),u(o)})(n,C,E.value,L.value,f,m),k.textContent="Сохранение..."})),A.addEventListener("click",(function(){H(B,T),l(w,{inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"}),U.textContent="Создать",r(x)})),d.forEach((function(t){t.classList.add("popup_is-animated"),t.addEventListener("click",(function(e){return function(t,e){(t.target.classList.contains("popup__close")||t.target.classList.contains("popup"))&&u(e)}(e,t)}))})),p={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},Array.from(document.querySelectorAll(p.formSelector)).forEach((function(t){!function(t,e){var n=Array.from(t.querySelectorAll(e.inputSelector)),o=e.inputErrorClass,r=e.errorClass,u=t.querySelector(e.submitButtonSelector),c=e.inactiveButtonClass;i(n,u,c),n.forEach((function(e){e.addEventListener("input",(function(){!function(t,e,n,o){e.validity.patternMismatch?e.setCustomValidity(e.dataset.errorMessage):e.setCustomValidity(""),e.validity.valid?a(t,e,n,o):function(t,e,n,o){var r=t.querySelector(".".concat(e.id,"-error"));e.classList.add(n),r.textContent=e.validationMessage,r.classList.add(o)}(t,e,n,o)}(t,e,o,r),i(n,u,c)}))}))}(t,p)}))})();
//# sourceMappingURL=main.js.map