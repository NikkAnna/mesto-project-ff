(()=>{"use strict";var e={baseUrl:"https://nomoreparties.co/v1/wff-cohort-12",headers:{authorization:"8f4967ce-f48f-4d37-a0f6-afbb9d7f6d1e","Content-Type":"application/json"}},t=function(e){return e.ok?e.json():Promise.reject("Что-то пошло не так: ".concat(e.status))},n=document.querySelector("#card-template").content;function o(e,t,o,a,u,i){var l=n.querySelector(".places__item").cloneNode(!0),s=l.querySelector(".card__image");s.src=e.link,l.querySelector(".card__title").textContent=e.name,s.alt=e.name,s.addEventListener("click",(function(){return o(e.link,e.name)}));var d=e.likes.length,p=l.querySelector(".card__like-counter");p.textContent=d;var f=l.querySelector(".card__like-button");f.addEventListener("click",(function(t){a(t,e._id,p)})),e.likes.some((function(e){return e._id===t}))?r(f):c(f);var _=l.querySelector(".card__delete-button");return e.owner._id===t?(_.addEventListener("click",(function(){u(e._id,l,i)})),_.classList.remove("card__delete-button_inactive")):_.classList.add("card__delete-button_inactive"),l}function r(e){e.classList.add("card__like-button_is-active")}function c(e){e.classList.remove("card__like-button_is-active")}function a(e,t){e.textContent=t.likes.length}function u(e){e.classList.add("popup_is-opened"),document.addEventListener("keydown",l)}function i(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",l)}function l(e){"Escape"===e.key&&i(document.querySelector(".popup_is-opened"))}function s(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n),r.classList.remove(o),r.textContent=""}function d(e,t){e.disabled=!0,e.classList.add(t)}function p(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?function(e,t){e.disabled=!1,e.classList.remove(t)}(t,n):d(t,n)}function f(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=t.inputErrorClass,r=t.errorClass,c=e.querySelector(t.submitButtonSelector);n.forEach((function(t){s(e,t,o,r)})),d(c,t.inactiveButtonClass)}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}var m=document.querySelectorAll(".popup"),y=document.querySelector(".places__list"),v=document.querySelector(".profile__title"),h=document.querySelector(".profile__description"),b=document.querySelector(".profile__image"),S=document.querySelector(".popup_type_new-avatar"),q=document.forms["new-avatar"],g=document.querySelector(".popup__input_type_avatar_url"),C=S.querySelector(".popup__button"),E=document.querySelector(".popup_type_edit"),L=document.querySelector(".profile__edit-button"),k=document.forms["edit-profile"],x=document.querySelector(".popup__input_type_name"),A=document.querySelector(".popup__input_type_description"),w=E.querySelector(".popup__button"),U=document.querySelector(".popup_type_new-card"),T=document.querySelector(".profile__add-button"),j=document.forms["new-place"],O=document.querySelector(".popup__input_type_card-name"),B=document.querySelector(".popup__input_type_url"),D=U.querySelector(".popup__button"),P=document.querySelector(".popup_type_image"),I=P.querySelector(".popup__image"),M=P.querySelector(".popup__caption"),N=document.forms["delete-form"],J=document.querySelector(".popup_type_delete-card"),G={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function H(n,o,u){n.target.classList.contains("card__like-button_is-active")?function(n){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(n),{method:"DELETE",headers:e.headers}).then(t)}(o).then((function(e){a(u,e),c(n.target)})).catch((function(e){console.log(e)})):function(n){return fetch("".concat(e.baseUrl,"/cards/likes/").concat(n),{method:"PUT",headers:e.headers}).then(t)}(o).then((function(e){a(u,e),r(n.target)})).catch((function(e){console.log(e)}))}function V(e,t){I.src=e,M.textContent=t,u(P)}var z=function(){};function $(n,o,r){u(r),z=function(c){c.preventDefault(),function(n,o){var r;(r=o,fetch("".concat(e.baseUrl,"/cards/").concat(r),{method:"DELETE",headers:e.headers}).then(t)).then((function(e){return n.remove()})).catch((function(e){console.log(e)}))}(o,n),i(r)}}var F={};Promise.all([fetch("".concat(e.baseUrl,"/users/me"),{method:"GET",headers:e.headers}).then(t),fetch("".concat(e.baseUrl,"/cards"),{method:"GET",headers:e.headers}).then(t)]).then((function(e){var t,n,r=(n=2,function(e){if(Array.isArray(e))return e}(t=e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,r,c,a,u=[],i=!0,l=!1;try{if(c=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;i=!1}else for(;!(i=(o=c.call(n)).done)&&(u.push(o.value),u.length!==t);i=!0);}catch(e){l=!0,r=e}finally{try{if(!i&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(l)throw r}}return u}}(t,n)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),c=r[0],a=r[1];F=c,v.textContent=c.name,h.textContent=c.about,b.style.backgroundImage="url(".concat(c.avatar,")"),a.forEach((function(e){var t;t=o(e,c._id,V,H,$,J),y.append(t)}))})).catch((function(e){console.log(e)})),N.addEventListener("submit",(function(e){z(e)})),j.addEventListener("submit",(function(n){!function(n,r,c,a,u,l,s,d,p,f){var _;n.preventDefault(),D.textContent="Создание...",(_={name:a.value,link:c.value},fetch("".concat(e.baseUrl,"/cards"),{method:"POST",headers:e.headers,body:JSON.stringify(_)}).then(t)).then((function(e){var t=o(e,d._id,u,l,p,f);s.prepend(t),i(r)})).catch((function(e){console.log(e)})).finally((function(){D.textContent="Создать"}))}(n,U,B,O,V,H,y,F,$,J)})),b.addEventListener("click",(function(){g.value="",f(q,G),u(S)})),q.addEventListener("submit",(function(n){!function(n,o,r,c){n.preventDefault(),C.textContent="Сохранение...",function(n){return fetch("".concat(e.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:e.headers,body:JSON.stringify({avatar:n})}).then(t)}(r).then((function(e){c.style.backgroundImage="url(".concat(e.avatar,")"),i(o)})).catch((function(e){console.log(e)})).finally((function(){C.textContent="Сохранить"}))}(n,S,g.value,b)})),L.addEventListener("click",(function(){!function(e,t,n,o){e.value=n,t.value=o}(x,A,v.textContent,h.textContent),f(k,G),u(E)})),k.addEventListener("submit",(function(n){!function(n,o,r,c,a,u){var l;n.preventDefault(),w.textContent="Сохранение...",(l={name:r.value,about:c.value},fetch("".concat(e.baseUrl,"/users/me"),{method:"PATCH",headers:e.headers,body:JSON.stringify(l)}).then(t)).then((function(e){a.textContent=e.name,u.textContent=e.about,i(o)})).catch((function(e){console.log(e)})).finally((function(){w.textContent="Сохранить"}))}(n,E,x,A,v,h)})),T.addEventListener("click",(function(){var e;e=B,O.value="",e.value="",f(j,G),u(U)})),m.forEach((function(e){e.classList.add("popup_is-animated"),e.addEventListener("click",(function(t){return function(e,t){(e.target.classList.contains("popup__close")||e.target.classList.contains("popup"))&&i(t)}(t,e)}))})),function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),o=t.inputErrorClass,r=t.errorClass,c=e.querySelector(t.submitButtonSelector),a=t.inactiveButtonClass;p(n,c,a),n.forEach((function(t){t.addEventListener("input",(function(){!function(e,t,n,o){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?s(e,t,n,o):function(e,t,n,o){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.add(n),r.textContent=t.validationMessage,r.classList.add(o)}(e,t,n,o)}(e,t,o,r),p(n,c,a)}))}))}(t,e)}))}(G)})();
//# sourceMappingURL=main.js.map